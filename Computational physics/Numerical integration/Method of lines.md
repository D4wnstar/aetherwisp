---
wiki-publish: true
---
The **method of lines** (**MOL**) is an algorithmic method to numerically evaluate a [[partial differential equation]] by reducing it to a system of approximated [[Ordinary differential equation|ordinary differential equations]]. The basic idea is to convert all derivatives into algebraic approximations, except the derivative that we want to numerically evaluated. In physics, this is usually time, while space derivatives are approximated.
### Method
To illustrate, consider the [[heat equation]]
$$\frac{ \partial u }{ \partial t } =\frac{ \partial ^{2}u }{ \partial x^{2} } $$
This is a second order partial differential equation in time and space. The solution is the function $u(x,t)$ for which the above condition is true. $u(x,t)$ is a function of two variables, so its graph is a [[surface]]. We want some way to approximate this surface. To do so, we're going to remove the spatial derivative, keeping only the temporal one, but we can't just delete the term. What we'll instead do is to approximate the derivative *algebraically*, that is, by taking the definition of [[partial derivative]] as a [[limit]] and turning it into a [[finite difference]] (FD):
$$\frac{ \partial u }{ \partial x }=\lim_{ \Delta x \to 0 } \frac{u(x+\Delta x,t)-u(x,t)}{\Delta x} \simeq\frac{u(x+\Delta x,t)-u(x,t)}{\Delta x}$$
where we set $\Delta x$ to be a nonzero, finite number. What is $\Delta x$? It's the spacing between the points where we evaluate the derivative. Since we are going to use FDs to replace spatial derivatives, this suggests we turn the spatial part of the equation into a *grid*, then evaluate the equation only at these discrete grid points, with $\Delta x$ now becoming the *grid spacing*. If we have $m$ grid points $x_{1},\ldots,x_{m}$, the FD of the spatial derivative at the $i$-th point is
$$\frac{ \partial u_{i} }{ \partial x } \simeq \frac{u(x_{i+1},t)-u(x_{i},t)}{\Delta x}=\frac{u_{i+1}-u_{i}}{\Delta x}$$
where we defined $u_{i}\equiv u(x_{i},t)$ for brevity. Since $x_{i}$ is a predefined constant, there is no longer a dependency on $x$; $u$ is now just a function of $t$. This is the key of method of lines, but first, let's see what we get from the approximation of a *second* derivative:
$$\frac{ \partial ^{2} u_{i} }{ \partial x^{2} }\simeq \cfrac{\cfrac{ \partial u_{i+1} }{ \partial x }- \cfrac{ \partial u_{i} }{ \partial x }}{\Delta x} = \cfrac{\cfrac{u_{i+1}-u_{i}}{\Delta x}-\cfrac{u_{i}-u_{i-1}}{\Delta x}}{\Delta x} = \frac{u_{i+1}-2u_{i}+u_{i-1}}{\Delta x^{2}}$$
Since we know what the second spatial derivative is at every grid point we can plug it into the heat equation to state
$$\dot{u}_{i}=\frac{u_{i+1}-2u_{i}+u_{i-1}}{\Delta x^{2}}$$
using dot notation for the time derivative. Notice how, since there is no longer an $x$ dependency, this is now an *ordinary* differential equation in time, and that there is one of these for every single grid point, $\dot{u}_{1},\ldots,\dot{u}_{m}$. Thus, we took an individual PDE and turned it into $m$ ODEs that describe the same phenomenon, with some concessions due to the grid approximation. The critical part here is that because we can just turn a PDE into a system of ODEs, we can just solve the ODEs with any old ODE integration method, like the [[Runge-Kutta methods]] or anything else. In other words, the MOL consists of reducing a PDE into an equivalent system of ODEs and then evaluating those with existing methods. This is where the name comes from: each ODE will draw a trajectory (*line*) for each grid point over time and the surface of the PDE that we're looking for is the interpolation between all of these lines.

:::image
![[MOL Schrödinger.png]]
A simulation of the [[Schrödinger equation]] using the method of lines. The left plot shows the namesake lines drawn by the ODEs for each grid point. The right plot is the surface interpolated by those lines.
:::

The MOL is valuable because it's so versatile. Since you end up with plain ODEs, you get to reuse the enormous amount of research done on ODEs "for free", without having to create a new bespoke method to simulate PDEs. Moreover, the usage of finite differences above is a matter of choice: *any* algebraic approximation of a derivative will work well so long it ends up with an ODE. As such, the method of lines is more of a framework than a method, where you get to apply existing algorithms and approximations to best fit your individual use case. But this comes at a cost: since you're discretizing space in a grid, the precision of your simulation is limited by the number of grid points you choose. But since each grid point comes with an ODE, if you want a high precision simulation you may very well end up with a system of *hundreds* of ODEs that need to be solved simultaneously, which can get very performance intensive very fast. As such, choosing the grid spacing means choosing between performance and precision. For reference, the simulation in the figure uses 100 grid points in a grid between $-5$ and $+5$, meaning a grid spacing of $\Delta x=0.1$.